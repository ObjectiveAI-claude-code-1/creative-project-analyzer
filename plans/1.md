# Implementation Plan: creative-project-analyzer

## Overview

This plan describes the implementation of a **Vector Function** that evaluates creative projects across 8 distinct dimensions. Per SPEC requirements:
- 4 tasks are always evaluated (unmapped)
- 4 tasks are conditionally evaluated based on optional input fields (mapped)
- Each task is distinctly different from the others

The function is type `vector.function` and produces a vector of scalar scores.

---

## Input Schema Structure

```json
{
  "type": "object",
  "description": "A creative project to evaluate across multiple dimensions of artistic and practical merit",
  "properties": {
    "work": {
      "anyOf": [
        {
          "type": "string",
          "description": "A text description of the creative project, including its concept, execution, medium, and any relevant details"
        },
        {
          "type": "image",
          "description": "Visual documentation of the creative work (photograph, render, screenshot, or the work itself)"
        },
        {
          "type": "video",
          "description": "Video documentation of the creative work (especially for time-based, performative, or interactive works)"
        },
        {
          "type": "audio",
          "description": "Audio recording of the creative work (for musical or sound-based projects)"
        }
      ]
    },
    "creator_statement": {
      "type": "string",
      "description": "Optional: The creator's statement describing their intent, goals, vision, and what they set out to achieve with this work"
    },
    "target_audience": {
      "type": "string", 
      "description": "Optional: Description of the intended audience (demographics, expertise level, cultural context, expectations)"
    },
    "project_constraints": {
      "type": "string",
      "description": "Optional: Description of constraints the project was created under (budget, timeline, materials, client requirements, technical limitations)"
    },
    "references": {
      "type": "string",
      "description": "Optional: List or description of reference works, influences, and inspirations that informed the project"
    }
  },
  "required": ["work"]
}
```

### Field Breakdown

| Field | Required | Type | Purpose |
|-------|----------|------|---------|
| `work` | Yes | string/image/video/audio | The creative work itself |
| `creator_statement` | No | string | Enables Intentional Coherence task |
| `target_audience` | No | string | Enables Audience Resonance task |
| `project_constraints` | No | string | Enables Constraint Navigation task |
| `references` | No | string | Enables Contextual Positioning task |

---

## Input Maps for Mapped Task Execution

Since we have 4 conditional tasks that should only run when their corresponding optional fields are present, we need input maps that evaluate to `null` when the optional field is absent (causing the task to be skipped).

### Input Map Definitions

```json
"input_maps": {
  "with_creator_statement": {
    "$starlark": "input if input.get('creator_statement') else None"
  },
  "with_target_audience": {
    "$starlark": "input if input.get('target_audience') else None"
  },
  "with_project_constraints": {
    "$starlark": "input if input.get('project_constraints') else None"
  },
  "with_references": {
    "$starlark": "input if input.get('references') else None"
  }
}
```

These input maps check for the presence of the optional field and return:
- The full input object if the field exists → task executes
- `None` if the field is absent → task is skipped

---

## Function Definition Structure

```json
{
  "type": "vector.function",
  "description": "Evaluates creative projects across multiple dimensions of artistic merit. Always assesses conceptual originality, technical execution, emotional resonance, and aesthetic cohesion. Conditionally evaluates intentional coherence, audience resonance, constraint navigation, and contextual positioning when relevant context is provided.",
  "input_schema": { ... },
  "input_maps": { ... },
  "tasks": [
    // 4 unmapped tasks (always run)
    // 4 mapped tasks (conditional)
  ]
}
```

---

## Task Definitions

### Unmapped Tasks (Always Evaluated)

#### Task 1: Conceptual Originality

**Type**: `vector.completion` with 4 sub-evaluations

**Sub-dimensions**:
1. Idea Freshness (HIGH/LOW)
2. Perspective Novelty (HIGH/LOW)
3. Combinatorial Creativity (HIGH/LOW)
4. Revelatory Quality (HIGH/LOW)

**Output expression**: Average of the 4 HIGH scores
```starlark
(output['scores'][1]) * 0.25
```
(Each sub-task contributes 0.25 when HIGH)

#### Task 2: Technical Execution

**Type**: `vector.completion` with 4 sub-evaluations

**Sub-dimensions**:
1. Skill Demonstration (None/Low/Medium/High/Exceptional)
2. Finish and Polish (None/Low/Medium/High/Exceptional)
3. Technical Ambition (None/Low/Medium/High/Exceptional)
4. Problem-Solving (None/Low/Medium/High/Exceptional)

**Output expression**: Weighted sum across 5 levels (0, 0.25, 0.5, 0.75, 1.0)

#### Task 3: Emotional Resonance

**Type**: `vector.completion` with 4 sub-evaluations

**Sub-dimensions**:
1. Emotional Specificity (WEAK/STRONG)
2. Emotional Depth (WEAK/STRONG)
3. Affective Authenticity (WEAK/STRONG)
4. Lasting Impression (WEAK/STRONG)

**Output expression**: Average of STRONG scores

#### Task 4: Aesthetic Cohesion

**Type**: `vector.completion` with 4 sub-evaluations

**Sub-dimensions**:
1. Sensory Harmony (Poor/Fair/Good/Excellent)
2. Tonal Consistency (Poor/Fair/Good/Excellent)
3. Intentional Contrast (Poor/Fair/Good/Excellent)
4. Gestalt Quality (Poor/Fair/Good/Excellent)

**Output expression**: Weighted sum across 4 levels

---

### Mapped Tasks (Conditionally Evaluated)

#### Task 5: Intentional Coherence

**Input map**: `with_creator_statement`

**Type**: `vector.completion` with 4 sub-evaluations

**Sub-dimensions**:
1. Goal Achievement (MISALIGNED/ALIGNED)
2. Means-Ends Alignment (MISALIGNED/ALIGNED)
3. Self-Awareness (MISALIGNED/ALIGNED)
4. Authentic Ambition (MISALIGNED/ALIGNED)

**System prompt context**: Must reference both `input.work` and `input.creator_statement`

#### Task 6: Audience Resonance

**Input map**: `with_target_audience`

**Type**: `vector.completion` with 4 sub-evaluations

**Sub-dimensions**:
1. Accessibility (Poor/Fair/Good/Excellent)
2. Relevance (Poor/Fair/Good/Excellent)
3. Register Appropriateness (Poor/Fair/Good/Excellent)
4. Cultural Fluency (Poor/Fair/Good/Excellent)

**System prompt context**: Must reference both `input.work` and `input.target_audience`

#### Task 7: Constraint Navigation

**Input map**: `with_project_constraints`

**Type**: `vector.completion` with 4 sub-evaluations

**Sub-dimensions**:
1. Resourcefulness (STRUGGLED/THRIVED)
2. Constraint Transformation (STRUGGLED/THRIVED)
3. Scope Calibration (STRUGGLED/THRIVED)
4. Graceful Compromise (STRUGGLED/THRIVED)

**System prompt context**: Must reference both `input.work` and `input.project_constraints`

#### Task 8: Contextual Positioning

**Input map**: `with_references`

**Type**: `vector.completion` with 4 sub-evaluations

**Sub-dimensions**:
1. Influence Integration (Poor/Fair/Good/Excellent)
2. Tradition Awareness (Poor/Fair/Good/Excellent)
3. Productive Departure (Poor/Fair/Good/Excellent)
4. Contribution Clarity (Poor/Fair/Good/Excellent)

**System prompt context**: Must reference both `input.work` and `input.references`

---

## Expressions to Write

### Input Map Expressions (Starlark)

```starlark
# with_creator_statement
input if input.get('creator_statement') else None

# with_target_audience
input if input.get('target_audience') else None

# with_project_constraints
input if input.get('project_constraints') else None

# with_references
input if input.get('references') else None
```

### Message Content Expressions

**For unmapped tasks (work only)**:
```jmespath
input.work
```

**For mapped tasks (work + context)**:
```starlark
# Intentional Coherence
'CREATIVE WORK:\n' + str(input['work']) + '\n\nCREATOR STATEMENT:\n' + input['creator_statement']

# Audience Resonance
'CREATIVE WORK:\n' + str(input['work']) + '\n\nTARGET AUDIENCE:\n' + input['target_audience']

# Constraint Navigation
'CREATIVE WORK:\n' + str(input['work']) + '\n\nPROJECT CONSTRAINTS:\n' + input['project_constraints']

# Contextual Positioning
'CREATIVE WORK:\n' + str(input['work']) + '\n\nREFERENCES AND INFLUENCES:\n' + input['references']
```

### Output Aggregation Expressions

**Binary HIGH/LOW (4 sub-tasks)**:
```starlark
output['scores'][1]  # Just take the HIGH score for each
```

**5-level weighted (None/Low/Medium/High/Exceptional)**:
```starlark
output['scores'][0] * 0.0 + output['scores'][1] * 0.25 + output['scores'][2] * 0.5 + output['scores'][3] * 0.75 + output['scores'][4] * 1.0
```

**4-level weighted (Poor/Fair/Good/Excellent)**:
```starlark
output['scores'][0] * 0.0 + output['scores'][1] * 0.33 + output['scores'][2] * 0.67 + output['scores'][3] * 1.0
```

**Binary WEAK/STRONG or STRUGGLED/THRIVED**:
```starlark
output['scores'][1]  # Score for STRONG/THRIVED
```

---

## Test Inputs

### Test 1: Minimal Input (Only Required Field)

**Purpose**: Verify only 4 unmapped tasks execute

```json
{
  "work": "A large-scale oil painting depicting a crowded subway car at rush hour. The artist uses a muted palette of grays and browns, with occasional pops of color from passengers' clothing. Faces are rendered in soft focus while hands gripping poles and phones are sharply detailed. The composition creates a sense of compression and isolation despite the crowd."
}
```

**Expected**: 4 scores (originality, execution, resonance, cohesion)

---

### Test 2: All Optional Fields Provided

**Purpose**: Verify all 8 tasks execute

```json
{
  "work": "An interactive digital installation where visitors' shadows trigger musical notes. As people move through the space, their shadows fall on floor sensors that generate harmonies based on shadow size and movement speed. Multiple visitors create collaborative, ever-changing compositions.",
  "creator_statement": "I wanted to explore how strangers can create beauty together without intention or coordination. The piece asks whether meaningful collaboration requires conscious choice, and celebrates the accidental art we make just by existing in shared spaces.",
  "target_audience": "Contemporary art museum visitors, particularly those interested in interactive and new media art. The piece is designed to be accessible to all ages and requires no special knowledge or instructions.",
  "project_constraints": "Budget of $15,000, 6-week installation timeline, limited to off-the-shelf components due to supply chain issues. The museum required the piece to be silent after hours and fully accessible per ADA requirements.",
  "references": "Inspired by Christian Marclay's 'The Clock', Ryoji Ikeda's data visualizations, and Brian Eno's generative music systems. Also influenced by phenomenological philosophy, particularly Merleau-Ponty's work on embodiment."
}
```

**Expected**: 8 scores

---

### Test 3: Partial Optional Fields (2 of 4)

**Purpose**: Verify correct conditional task execution

```json
{
  "work": "A short animated film (4 minutes) following a paper crane as it travels through a rainy city, seeking shelter. No dialogue. The animation style blends traditional hand-drawn elements with digital rain effects. The crane eventually finds refuge in a child's bedroom, where it is welcomed into a collection of origami figures.",
  "creator_statement": "This film explores the universal experience of seeking belonging. The crane represents anyone who feels out of place, and its journey is meant to offer hope that there is a home for everyone, even when the world seems unwelcoming.",
  "target_audience": "Family audiences, suitable for children 5+ but with emotional depth for adults. Intended for film festival circuit and potentially streaming platforms."
}
```

**Expected**: 6 scores (4 base + intentional_coherence + audience_resonance)

---

### Test 4: Image Input

**Purpose**: Verify image type handling

```json
{
  "work": {
    "type": "image",
    "url": "https://example.com/artwork.jpg"
  },
  "creator_statement": "This piece examines the tension between natural and artificial light in urban environments at dusk."
}
```

**Expected**: 5 scores (4 base + intentional_coherence)

---

### Test 5: Video Input with Constraints Only

**Purpose**: Test video type with single optional field

```json
{
  "work": {
    "type": "video",
    "url": "https://example.com/performance.mp4"
  },
  "project_constraints": "Site-specific performance created in 48 hours for a guerrilla art festival. No budget, two performers, could only use materials found on-site. Had to be silent due to noise restrictions."
}
```

**Expected**: 5 scores (4 base + constraint_navigation)

---

### Test 6: Highly Derivative/Low-Quality Work

**Purpose**: Test low-end of scoring range

```json
{
  "work": "A painting of a sunset over the ocean with palm trees in the foreground. Painted in the style typically seen in hotel room art. Standard composition with the sun centered on the horizon, orange and purple gradient sky, silhouetted trees.",
  "references": "Inspired by Thomas Kinkade and hotel lobby art in general."
}
```

**Expected**: 5 scores, likely low on originality and contextual_positioning

---

### Test 7: Highly Experimental/Conceptual Work

**Purpose**: Test high-end and edge case handling

```json
{
  "work": "A piece consisting entirely of a legal contract. The contract stipulates that whoever signs it agrees to think about the concept of 'art' for exactly 17 minutes at some point in the next year. The contract is displayed in a gallery in a standard black frame. The piece is titled 'Agreement'.",
  "creator_statement": "I'm interested in where art exists—in objects, experiences, or agreements between people. This piece asks whether art can exist purely as a commitment, with no physical manifestation beyond the document itself.",
  "target_audience": "Conceptual art enthusiasts, philosophy students, and visitors to contemporary art museums who enjoy being challenged.",
  "project_constraints": "Created for a group show with the theme 'Invisible Art'. Budget was $200 including framing. The piece had to be completable by any visitor.",
  "references": "Building on Sol LeWitt's instruction-based works, Yoko Ono's instruction pieces, and exploring territories opened by Marcel Duchamp's readymades and institutional critique."
}
```

**Expected**: 8 scores, testing the function's ability to handle highly conceptual work

---

### Test 8: Audio Work

**Purpose**: Verify audio type handling

```json
{
  "work": {
    "type": "audio",
    "url": "https://example.com/composition.mp3"
  },
  "creator_statement": "A 12-minute ambient composition created using only field recordings from my grandmother's kitchen. The piece processes these sounds into drones and textures while preserving their domestic quality.",
  "references": "Influenced by Éliane Radigue's drone works, the Caretaker's memory-focused ambient pieces, and musique concrète traditions."
}
```

**Expected**: 6 scores (4 base + intentional_coherence + contextual_positioning)

---

## Output Vector Structure

The function produces a vector of scores. The number of elements depends on which optional fields are provided:

| Optional Fields Provided | Output Dimensions |
|--------------------------|-------------------|
| None | 4 |
| creator_statement only | 5 |
| target_audience only | 5 |
| project_constraints only | 5 |
| references only | 5 |
| Any 2 | 6 |
| Any 3 | 7 |
| All 4 | 8 |

**Output order**:
1. conceptual_originality (always)
2. technical_execution (always)
3. emotional_resonance (always)
4. aesthetic_cohesion (always)
5. intentional_coherence (if creator_statement provided)
6. audience_resonance (if target_audience provided)
7. constraint_navigation (if project_constraints provided)
8. contextual_positioning (if references provided)

---

## Implementation Notes

1. **Task distinctiveness**: Each of the 8 tasks evaluates a fundamentally different dimension. There is no overlap between technical execution (craft) and emotional resonance (feeling), or between originality (novelty) and cohesion (unity).

2. **Sub-task structure**: Each main task contains 4 `vector.completion` sub-evaluations that assess different facets of the dimension. These are aggregated into a single score per dimension.

3. **Response scale consistency**: 
   - Binary tasks use HIGH/LOW, STRONG/WEAK, or ALIGNED/MISALIGNED
   - Multi-level tasks use either 4 levels (Poor/Fair/Good/Excellent) or 5 levels (None/Low/Medium/High/Exceptional)

4. **Skip behavior**: When an optional field is absent, the corresponding input map returns `None`, causing the task to be skipped entirely (no score produced for that dimension).

5. **Media flexibility**: The `work` field accepts text, image, video, or audio, allowing the function to evaluate any type of creative project.
